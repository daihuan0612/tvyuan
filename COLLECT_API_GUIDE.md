# API自动搜集功能使用指南

## 功能概述

本项目新增了自动搜集网络API资源的功能，可以定期从网络上发现新的视频API资源，验证其有效性并筛选高质量资源后自动添加到配置文件中。

## 工作原理

1. **API发现**：通过预定义的模式和常见域名生成潜在的API地址，并从公开API目录获取资源
2. **有效性验证**：测试API的连通性和搜索功能
3. **质量筛选**：筛选高质量API（去广告、高清/2K/4K等）
4. **去重处理**：避免重复添加已存在的API
5. **自动添加**：将验证有效的高质量API添加到配置文件中
6. **报告生成**：生成搜集报告记录操作详情

## 使用方法

### 手动运行

```bash
# 运行API搜集脚本
npm run collect
```

### 自动运行

GitHub Actions工作流会按照设定的时间自动运行API搜集任务：
- **频率**：每周运行一次（已改为每月）
- **时间**：北京时间每周日凌晨0点
- **工作流文件**：`.github/workflows/collect-apis.yml`

首次部署时，建议手动触发一次工作流以立即搜集API资源。

> **注意**：默认的API源仅为示例，实际使用时需要替换为真实可用的API目录源。

## 配置说明

### 主要文件

- `collect_apis.js`：API搜集脚本
- `.github/workflows/collect-apis.yml`：自动搜集工作流
- `collection_report.md`：搜集报告

### 自定义配置

1. **API模式**：在`collect_apis.js`中修改`API_PATTERNS`数组
2. **域名前缀/后缀**：在`generatePotentialApis()`函数中修改相关数组
3. **搜索关键词**：修改`SEARCH_KEYWORD`常量

## 注意事项

1. **网络请求限制**：脚本包含重试机制和超时设置，避免因网络问题导致失败
2. **API验证**：只添加经过验证的有效API，确保质量
3. **去重机制**：自动避免重复添加相同的API
4. **报告记录**：每次运行都会生成详细的搜集报告

## 扩展建议

1. **添加更多API源**：可以添加公开的API目录网站到`SOURCES`数组
2. **改进发现算法**：可以集成网页爬虫技术从论坛、博客等地方发现API
3. **智能分类**：自动识别API类型并进行分类标记
4. **黑名单机制**：维护一个黑名单，避免添加已知的无效或恶意API
